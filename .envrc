# Load the nix flake
use flake

# Python virtual environment management
VENV_DIR=".venv"

if [ ! -d "$VENV_DIR" ]; then
  echo "Creating virtual environment in $VENV_DIR..."
  python -m venv "$VENV_DIR"
fi

# Activate the virtual environment
source "$VENV_DIR/bin/activate"

# Export the virtual environment path to prevent it from being loaded twice
export VIRTUAL_ENV="$PWD/$VENV_DIR"
export PATH="$VIRTUAL_ENV/bin:$PATH"

# Ensure pip, setuptools, and wheel are up to date
pip install --upgrade pip setuptools wheel --quiet

# Install prefect package
pip install dagster --quiet
